<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>

    <!-- Apply dark mode immediately if enabled -->
    <script src="/dark-mode.js"></script>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/styles.css" />
    <style>
      .checkout-container {
        max-width: 700px;
        margin: 2rem auto;
      }
      .checkout-header {
        text-align: center;
        margin-bottom: 2rem;
      }
      .checkout-card {
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        margin-bottom: 2rem;
      }
      .checkout-summary {
        background: #f8f9fa;
        padding: 1.5rem;
        border-bottom: 1px solid #e9ecef;
      }
      .checkout-form {
        padding: 2rem;
      }
      .payment-header {
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid #e9ecef;
      }
      .form-group {
        margin-bottom: 1.5rem;
      }

      /* Dark Mode Styles for Checkout Page */
      html.dark-mode .checkout-container {
        background-color: #121212;
        color: #e0e0e0;
      }

      html.dark-mode .checkout-card {
        background-color: #1e1e1e;
        color: #e0e0e0;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      html.dark-mode .checkout-summary {
        background-color: #262626;
        color: #e0e0e0;
        border-color: #333;
      }

      html.dark-mode .form-control,
      html.dark-mode .form-select {
        background-color: #333;
        color: #e0e0e0;
        border-color: #444;
      }

      html.dark-mode .form-control:focus,
      html.dark-mode .form-select:focus {
        background-color: #333;
        color: #e0e0e0;
        border-color: #007bff;
        box-shadow: 0 0 0 0.25rem rgba(0, 123, 255, 0.25);
      }

      html.dark-mode .payment-header {
        border-color: #333;
      }

      html.dark-mode .form-label {
        color: #e0e0e0;
      }

      html.dark-mode .form-check-label {
        color: #e0e0e0;
      }

      html.dark-mode .payment-method-option {
        border-color: #444;
        background-color: #1e1e1e;
        color: #e0e0e0;
      }

      html.dark-mode .payment-method-option:hover {
        border-color: var(--primary-color);
        background-color: #262626;
      }

      html.dark-mode .payment-method-option.selected {
        border-color: var(--primary-color);
        background-color: rgba(0, 123, 255, 0.2);
      }

      html.dark-mode .payment-instructions {
        background-color: #262626;
        color: #e0e0e0;
      }
      .payment-methods {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
      }
      .payment-method-option {
        flex: 1;
        border: 1px solid #dee2e6;
        border-radius: 10px;
        padding: 1rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .payment-method-option:hover {
        border-color: var(--primary-color);
        background-color: #f8f9fa;
      }
      .payment-method-option.selected {
        border-color: var(--primary-color);
        background-color: rgba(13, 110, 253, 0.1);
      }
      .payment-method-icon {
        font-size: 2rem;
        margin-bottom: 0.5rem;
      }
      .payment-instructions {
        padding: 1rem;
        background: #f8f9fa;
        border-radius: 10px;
        margin-bottom: 1.5rem;
      }
      .card-row {
        display: flex;
        gap: 1rem;
      }
      .secure-badge {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 1rem;
        color: #6c757d;
      }
      .secure-badge i {
        margin-right: 0.5rem;
        color: #28a745;
      }
    </style>
  </head>
  <body>
    <%- include('../partials/navbar') %>

    <div class="container py-5">
      <div class="checkout-container">
        <div class="checkout-header">
          <h1>Complete Your Purchase</h1>
          <p class="text-muted">
            You're just one step away from unlocking premium access
          </p>
        </div>

        <div class="checkout-card">
          <div class="checkout-summary">
            <div class="row">
              <div class="col-md-8">
                <h5>Premium Subscription</h5>
                <p class="text-muted mb-0">
                  1 month of unlimited access to all quizzes
                </p>
              </div>
              <div class="col-md-4 text-md-end">
                <h5>PKR 1,000.00</h5>
              </div>
            </div>
          </div>

          <div class="checkout-form">
            <h4 class="payment-header">Payment Method</h4>
            <div class="payment-methods">
              <div
                class="payment-method-option selected"
                onclick="selectPaymentMethod(this, 'jazzcash')"
              >
                <div class="payment-method-icon">
                  <i class="fas fa-mobile-alt text-primary"></i>
                </div>
                <div class="payment-method-name">JazzCash</div>
              </div>
              <div
                class="payment-method-option"
                onclick="selectPaymentMethod(this, 'easypaisa')"
              >
                <div class="payment-method-icon">
                  <i class="fas fa-credit-card text-primary"></i>
                </div>
                <div class="payment-method-name">EasyPaisa</div>
              </div>
              <div
                class="payment-method-option"
                onclick="selectPaymentMethod(this, 'bank')"
              >
                <div class="payment-method-icon">
                  <i class="fas fa-university text-primary"></i>
                </div>
                <div class="payment-method-name">Bank Transfer</div>
              </div>
            </div>
            <div id="jazzcash-form">
              <div class="payment-instructions">
                <p class="mb-2">
                  <strong>JazzCash Payment Instructions:</strong>
                </p>
                <ol class="mb-0">
                  <li>Enter your JazzCash mobile number</li>
                  <li>You will receive a payment request</li>
                  <li>Confirm the payment in your JazzCash app</li>
                </ol>
              </div>

              <form action="/subscription/process-payment" method="POST">
                <div class="form-group">
                  <label for="jazzNumber" class="form-label"
                    >JazzCash Number</label
                  >
                  <input
                    type="tel"
                    class="form-control"
                    id="jazzNumber"
                    name="phoneNumber"
                    placeholder="03xxxxxxxxx"
                    pattern="[0-9]{11}"
                    required
                  />
                </div>
                <input type="hidden" name="paymentMethod" value="jazzcash" />
                <button type="submit" class="btn btn-primary btn-lg w-100">
                  <i class="fas fa-mobile-alt me-2"></i>Pay PKR 1,000 with
                  JazzCash
                </button>
              </form>
            </div>

            <div id="easypaisa-form" style="display: none">
              <div class="payment-instructions">
                <p class="mb-2">
                  <strong>EasyPaisa Payment Instructions:</strong>
                </p>
                <ol class="mb-0">
                  <li>Enter your EasyPaisa mobile number</li>
                  <li>You will receive a payment request</li>
                  <li>Confirm the payment in your EasyPaisa app</li>
                </ol>
              </div>

              <form action="/subscription/process-payment" method="POST">
                <div class="form-group">
                  <label for="easyNumber" class="form-label"
                    >EasyPaisa Number</label
                  >
                  <input
                    type="tel"
                    class="form-control"
                    id="easyNumber"
                    name="phoneNumber"
                    placeholder="03xxxxxxxxx"
                    pattern="[0-9]{11}"
                    required
                  />
                </div>
                <input type="hidden" name="paymentMethod" value="easypaisa" />
                <button type="submit" class="btn btn-primary btn-lg w-100">
                  <i class="fas fa-credit-card me-2"></i>Pay PKR 1,000 with
                  EasyPaisa
                </button>
              </form>
            </div>

            <div id="bank-form" style="display: none">
              <div class="payment-instructions">
                <p class="mb-2">
                  <strong>Bank Transfer Details:</strong>
                </p>
                <div class="card">
                  <div class="card-body">
                    <p><strong>Account Title:</strong> QuizMaster Pakistan</p>
                    <p><strong>Account Number:</strong> 1234567890123</p>
                    <p><strong>Bank:</strong> HBL Bank</p>
                    <p><strong>IBAN:</strong> PK12HABB0000001234567890</p>
                    <p class="mb-0"><strong>Amount:</strong> PKR 1,000</p>
                  </div>
                </div>
                <p class="mt-2 text-muted">
                  After transfer, click "Confirm Payment" to activate your
                  subscription.
                </p>
              </div>

              <form action="/subscription/process-payment" method="POST">
                <input type="hidden" name="paymentMethod" value="bank" />
                <button type="submit" class="btn btn-primary btn-lg w-100">
                  <i class="fas fa-university me-2"></i>Confirm Bank Transfer
                </button>
              </form>
            </div>

            <div class="secure-badge">
              <i class="fas fa-lock"></i> Secure Payment
            </div>
          </div>
        </div>

        <div class="text-center">
          <a href="/subscription" class="btn btn-link">
            <i class="fas fa-arrow-left me-2"></i>Return to subscription page
          </a>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      function selectPaymentMethod(element, method) {
        // Remove selected class from all options
        document
          .querySelectorAll(".payment-method-option")
          .forEach((option) => {
            option.classList.remove("selected");
          });

        // Add selected class to clicked option
        element.classList.add("selected"); // Hide all forms
        document.getElementById("jazzcash-form").style.display = "none";
        document.getElementById("easypaisa-form").style.display = "none";
        document.getElementById("bank-form").style.display = "none";

        // Show selected form
        document.getElementById(method + "-form").style.display = "block";
      }

      // Initialize dark mode when page loads
      document.addEventListener("DOMContentLoaded", initializeDarkMode);
    </script>
  </body>
</html>
